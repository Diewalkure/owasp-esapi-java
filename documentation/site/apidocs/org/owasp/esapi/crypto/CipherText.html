<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_11) on Wed Feb 10 21:41:10 CST 2010 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
CipherText (ESAPI 2.0 API)
</TITLE>

<META NAME="date" CONTENT="2010-02-10">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="CipherText (ESAPI 2.0 API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/CipherText.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/owasp/esapi/crypto/CipherSpec.html" title="class in org.owasp.esapi.crypto"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/owasp/esapi/crypto/CipherTextSerializer.html" title="class in org.owasp.esapi.crypto"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/owasp/esapi/crypto/CipherText.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CipherText.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.owasp.esapi.crypto</FONT>
<BR>
Class CipherText</H2>
<PRE>
<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>org.owasp.esapi.crypto.CipherText</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io">Serializable</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public final class <B>CipherText</B><DT>extends <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A><DT>implements <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/Serializable.html?is-external=true" title="class or interface in java.io">Serializable</A></DL>
</PRE>

<P>
A <code>Serializable</code> interface representing the result of encrypting
 plaintext and some additional information about the encryption algorithm,
 the IV (if pertinent), and an optional Message Authentication Code (MAC).
 </p><p>
 Note that while this class is <code>Serializable</code> in the usual Java sense,
 ESAPI uses <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#asPortableSerializedByteArray()"><CODE>asPortableSerializedByteArray()</CODE></A> for serialization. Not
 only is this serialization somewhat more compact, it is also portable
 across other ESAPI programming language implementations. However, Java
 serialization is supported in the event that one wishes to store
 <code>CipherText</code> in an <code>HttpSession</code> object.
 </p><p>
 Copyright &copy; 2009 - The OWASP Foundation
 </p>
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>2.0</DD>
<DT><B>Author:</B></DT>
  <DD>kevin.w.wall@gmail.com</DD>
<DT><B>See Also:</B><DD><A HREF="../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto"><CODE>PlainText</CODE></A>, 
<A HREF="../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi"><CODE>Encryptor</CODE></A>, 
<A HREF="../../../../serialized-form.html#org.owasp.esapi.crypto.CipherText">Serialized Form</A></DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#CipherText()">CipherText</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default CTOR.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#CipherText(org.owasp.esapi.crypto.CipherSpec)">CipherText</A></B>(<A HREF="../../../../org/owasp/esapi/crypto/CipherSpec.html" title="class in org.owasp.esapi.crypto">CipherSpec</A>&nbsp;cipherSpec)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Construct from a <code>CipherSpec</code> object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#CipherText(org.owasp.esapi.crypto.CipherSpec, byte[])">CipherText</A></B>(<A HREF="../../../../org/owasp/esapi/crypto/CipherSpec.html" title="class in org.owasp.esapi.crypto">CipherSpec</A>&nbsp;cipherSpec,
           byte[]&nbsp;cipherText)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Construct from a <code>CipherSpec</code> object and the raw ciphertext.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#asPortableSerializedByteArray()">asPortableSerializedByteArray</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return this <code>CipherText</code> object as a portable (i.e., network byte
 ordered) serialized byte array.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#canEqual(java.lang.Object)">canEqual</A></B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;other)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Needed for correct definition of equals for general classes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#computeAndStoreMAC(javax.crypto.SecretKey)">computeAndStoreMAC</A></B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/javax/crypto/SecretKey.html?is-external=true" title="class or interface in javax.crypto">SecretKey</A>&nbsp;authKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compute and store the Message Authentication Code (MAC) if the ESAPI property
 <code>Encryptor.CipherText.useMAC</code> is set to <code>true</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#equals(java.lang.Object)">equals</A></B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;other)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#fromPortableSerializedBytes(byte[])">fromPortableSerializedBytes</A></B>(byte[]&nbsp;bytes)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create a <code>CipherText</code> object from what is supposed to be a
  portable serialized byte array, given in network byte order, that
  represents a valid, previously serialized <code>CipherText</code> object
  using <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#asPortableSerializedByteArray()"><CODE>asPortableSerializedByteArray()</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getBase64EncodedRawCipherText()">getBase64EncodedRawCipherText</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return a base64-encoded representation of the raw ciphertext alone.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getBlockSize()">getBlockSize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retrieve the block size (in bytes!) of the cipher used for encryption.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getCipherAlgorithm()">getCipherAlgorithm</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Obtain the name of the cipher algorithm used for encrypting the
 plaintext.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getCipherMode()">getCipherMode</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the name of the cipher mode used to encrypt some plaintext.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getCipherTransformation()">getCipherTransformation</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Obtain the String representing the cipher transformation used to encrypt
 the plaintext.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getEncodedIVCipherText()">getEncodedIVCipherText</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the ciphertext as a base64-encoded <code>String</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getEncryptionTimestamp()">getEncryptionTimestamp</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get stored timestamp representing when data was encrypted.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getIV()">getIV</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the initialization vector (IV) used to encrypt the plaintext
 if applicable.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getKeySize()">getKeySize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retrieve the key size used with the cipher algorithm that was used to
 encrypt data to produce this ciphertext.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getPaddingScheme()">getPaddingScheme</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the name of the padding scheme used to encrypt some plaintext.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getRawCipherText()">getRawCipherText</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the raw ciphertext byte array resulting from encrypting some
 plaintext.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getRawCipherTextByteLength()">getRawCipherTextByteLength</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get number of bytes in raw ciphertext.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getSeparateMAC()">getSeparateMAC</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the separately calculated Message Authentication Code (MAC) that
 is computed via the <code>computeAndStoreMAC(SecretKey authKey)</code> method.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getSerialVersionUID()">getSerialVersionUID</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Used in supporting <code>CipherText</code> serialization.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#hashCode()">hashCode</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#requiresIV()">requiresIV</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return true if the cipher mode used requires an IV.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#setCiphertext(byte[])">setCiphertext</A></B>(byte[]&nbsp;ciphertext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the raw ciphertext.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#setIVandCiphertext(byte[], byte[])">setIVandCiphertext</A></B>(byte[]&nbsp;iv,
                   byte[]&nbsp;ciphertext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the IV and raw ciphertext.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;More useful <code>toString()</code> method.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#validateMAC(javax.crypto.SecretKey)">validateMAC</A></B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/javax/crypto/SecretKey.html?is-external=true" title="class or interface in javax.crypto">SecretKey</A>&nbsp;authKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Validate the message authentication code (MAC) associated with the ciphertext.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="CipherText()"><!-- --></A><H3>
CipherText</H3>
<PRE>
public <B>CipherText</B>()</PRE>
<DL>
<DD>Default CTOR. Takes all the defaults from the ESAPI.properties, or
 default values from initial values from this class (when appropriate)
 when they are not set in ESAPI.properties.
<P>
</DL>
<HR>

<A NAME="CipherText(org.owasp.esapi.crypto.CipherSpec)"><!-- --></A><H3>
CipherText</H3>
<PRE>
public <B>CipherText</B>(<A HREF="../../../../org/owasp/esapi/crypto/CipherSpec.html" title="class in org.owasp.esapi.crypto">CipherSpec</A>&nbsp;cipherSpec)</PRE>
<DL>
<DD>Construct from a <code>CipherSpec</code> object. Still needs to have
 <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#setCiphertext(byte[])"><CODE>setCiphertext(byte[])</CODE></A> or <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#setIVandCiphertext(byte[], byte[])"><CODE>setIVandCiphertext(byte[], byte[])</CODE></A>
 called to be usable.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>cipherSpec</CODE> - The cipher specification to use.</DL>
</DL>
<HR>

<A NAME="CipherText(org.owasp.esapi.crypto.CipherSpec, byte[])"><!-- --></A><H3>
CipherText</H3>
<PRE>
public <B>CipherText</B>(<A HREF="../../../../org/owasp/esapi/crypto/CipherSpec.html" title="class in org.owasp.esapi.crypto">CipherSpec</A>&nbsp;cipherSpec,
                  byte[]&nbsp;cipherText)
           throws <A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Construct from a <code>CipherSpec</code> object and the raw ciphertext.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>cipherSpec</CODE> - The cipher specification to use.<DD><CODE>cipherText</CODE> - The raw ciphertext bytes to use.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - Thrown if <code>cipherText</code> is null or
                   empty array.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="fromPortableSerializedBytes(byte[])"><!-- --></A><H3>
fromPortableSerializedBytes</H3>
<PRE>
public static <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A> <B>fromPortableSerializedBytes</B>(byte[]&nbsp;bytes)
                                              throws <A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Create a <code>CipherText</code> object from what is supposed to be a
  portable serialized byte array, given in network byte order, that
  represents a valid, previously serialized <code>CipherText</code> object
  using <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#asPortableSerializedByteArray()"><CODE>asPortableSerializedByteArray()</CODE></A>.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>bytes</CODE> - A byte array created via
              <code>CipherText.asPortableSerializedByteArray()</code>
<DT><B>Returns:</B><DD>A <code>CipherText</code> object reconstructed from the byte array.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE><DT><B>See Also:</B><DD><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#asPortableSerializedByteArray()"><CODE>asPortableSerializedByteArray()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getCipherTransformation()"><!-- --></A><H3>
getCipherTransformation</H3>
<PRE>
public <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>getCipherTransformation</B>()</PRE>
<DL>
<DD>Obtain the String representing the cipher transformation used to encrypt
 the plaintext. The cipher transformation represents the cipher algorithm,
 the cipher mode, and the padding scheme used to do the encryption. An
 example would be "AES/CBC/PKCS5Padding". See Appendix A in the
 <a href="http://java.sun.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html#AppA">
 Java Cryptography Architecture Reference Guide</a>
 for information about standard supported cipher transformation names.
 <p>
 The cipher transformation name is usually sufficient to be passed to
 <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/javax/crypto/Cipher.html?is-external=true#getInstance(java.lang.String)" title="class or interface in javax.crypto"><CODE>Cipher.getInstance(String)</CODE></A> to create a
 <code>Cipher</code> object to decrypt the ciphertext.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The cipher transformation name used to encrypt the plaintext
                   resulting in this ciphertext.</DL>
</DD>
</DL>
<HR>

<A NAME="getCipherAlgorithm()"><!-- --></A><H3>
getCipherAlgorithm</H3>
<PRE>
public <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>getCipherAlgorithm</B>()</PRE>
<DL>
<DD>Obtain the name of the cipher algorithm used for encrypting the
 plaintext.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The name as the cryptographic algorithm used to perform the
                   encryption resulting in this ciphertext.</DL>
</DD>
</DL>
<HR>

<A NAME="getKeySize()"><!-- --></A><H3>
getKeySize</H3>
<PRE>
public int <B>getKeySize</B>()</PRE>
<DL>
<DD>Retrieve the key size used with the cipher algorithm that was used to
 encrypt data to produce this ciphertext.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The key size in bits. We work in bits because that's the crypto way!</DL>
</DD>
</DL>
<HR>

<A NAME="getBlockSize()"><!-- --></A><H3>
getBlockSize</H3>
<PRE>
public int <B>getBlockSize</B>()</PRE>
<DL>
<DD>Retrieve the block size (in bytes!) of the cipher used for encryption.
 (Note: If an IV is used, this will also be the IV length.)
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The block size in bytes. (Bits, bytes! It's confusing I know. Blame
                                                                        the cryptographers; we've just following
                                                                        convention.)</DL>
</DD>
</DL>
<HR>

<A NAME="getCipherMode()"><!-- --></A><H3>
getCipherMode</H3>
<PRE>
public <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>getCipherMode</B>()</PRE>
<DL>
<DD>Get the name of the cipher mode used to encrypt some plaintext.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The name of the cipher mode used to encrypt the plaintext
         resulting in this ciphertext. E.g., "CBC" for "cipher block
         chaining", "ECB" for "electronic code book", etc.</DL>
</DD>
</DL>
<HR>

<A NAME="getPaddingScheme()"><!-- --></A><H3>
getPaddingScheme</H3>
<PRE>
public <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>getPaddingScheme</B>()</PRE>
<DL>
<DD>Get the name of the padding scheme used to encrypt some plaintext.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The name of the padding scheme used to encrypt the plaintext
                   resulting in this ciphertext. Example: "PKCS5Padding". If no
                   padding was used "None" is returned.</DL>
</DD>
</DL>
<HR>

<A NAME="getIV()"><!-- --></A><H3>
getIV</H3>
<PRE>
public byte[] <B>getIV</B>()</PRE>
<DL>
<DD>Return the initialization vector (IV) used to encrypt the plaintext
 if applicable.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The IV is returned if the cipher mode used to encrypt the
                        plaintext was not "ECB". ECB mode does not use an IV so in
                        that case, <code>null</code> is returned.</DL>
</DD>
</DL>
<HR>

<A NAME="requiresIV()"><!-- --></A><H3>
requiresIV</H3>
<PRE>
public boolean <B>requiresIV</B>()</PRE>
<DL>
<DD>Return true if the cipher mode used requires an IV. Usually this will
 be true unless ECB mode (which should be avoided whenever possible) is
 used.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getRawCipherText()"><!-- --></A><H3>
getRawCipherText</H3>
<PRE>
public byte[] <B>getRawCipherText</B>()</PRE>
<DL>
<DD>Get the raw ciphertext byte array resulting from encrypting some
 plaintext.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>A copy of the raw ciphertext as a byte array.</DL>
</DD>
</DL>
<HR>

<A NAME="getRawCipherTextByteLength()"><!-- --></A><H3>
getRawCipherTextByteLength</H3>
<PRE>
public int <B>getRawCipherTextByteLength</B>()</PRE>
<DL>
<DD>Get number of bytes in raw ciphertext. Zero is returned if ciphertext has not
 yet been stored.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The number of bytes of raw ciphertext; 0 if no raw ciphertext has been stored.</DL>
</DD>
</DL>
<HR>

<A NAME="getBase64EncodedRawCipherText()"><!-- --></A><H3>
getBase64EncodedRawCipherText</H3>
<PRE>
public <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>getBase64EncodedRawCipherText</B>()</PRE>
<DL>
<DD>Return a base64-encoded representation of the raw ciphertext alone. Even
 in the case where an IV is used, the IV is not prepended before the
 base64-encoding is performed.
 <p>
 If there is a need to store an encrypted value, say in a database, this
 is <i>not</i> the method you should use unless you are using a <i>fixed</i>
 IV. If you are <i>not</i> using a fixed IV, you should normally use
 <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getEncodedIVCipherText()"><CODE>getEncodedIVCipherText()</CODE></A> instead.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>See Also:</B><DD><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getEncodedIVCipherText()"><CODE>getEncodedIVCipherText()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getEncodedIVCipherText()"><!-- --></A><H3>
getEncodedIVCipherText</H3>
<PRE>
public <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>getEncodedIVCipherText</B>()</PRE>
<DL>
<DD>Return the ciphertext as a base64-encoded <code>String</code>. If an
 IV was used, the IV if first prepended to the raw ciphertext before
 base64-encoding. If an IV is not used, then this method returns the same
 value as <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getBase64EncodedRawCipherText()"><CODE>getBase64EncodedRawCipherText()</CODE></A>.
 <p>
 Generally, this is the method that you should use unless you only
 are using a fixed IV and a storing that IV separately, in which case
 using <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getBase64EncodedRawCipherText()"><CODE>getBase64EncodedRawCipherText()</CODE></A> can reduce the storage
 overhead.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The base64-encoded ciphertext or base64-encoded IV + ciphertext.<DT><B>See Also:</B><DD><A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#getBase64EncodedRawCipherText()"><CODE>getBase64EncodedRawCipherText()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="computeAndStoreMAC(javax.crypto.SecretKey)"><!-- --></A><H3>
computeAndStoreMAC</H3>
<PRE>
public void <B>computeAndStoreMAC</B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/javax/crypto/SecretKey.html?is-external=true" title="class or interface in javax.crypto">SecretKey</A>&nbsp;authKey)</PRE>
<DL>
<DD>Compute and store the Message Authentication Code (MAC) if the ESAPI property
 <code>Encryptor.CipherText.useMAC</code> is set to <code>true</code>. If it
 is, the MAC is conceptually calculated as:
 <pre>
                authKey = DerivedKey(secret_key, "authenticate")
                HMAC-SHA1(authKey, IV + secret_key)
 </pre>
 where derived key is an HMacSHA1, possibly repeated multiple times.
 (See <A HREF="../../../../org/owasp/esapi/crypto/CryptoHelper.html#computeDerivedKey(javax.crypto.SecretKey, int, java.lang.String)"><CODE>CryptoHelper.computeDerivedKey(SecretKey, int, String)</CODE></A>
 for details.)
 </p><p>
 <b>Perceived Benefits</b>: There are certain cases where if an attacker
 is able to change the IV. When one uses a authenticity key that is
 derived from the "master" key, it also makes it possible to know when
 the incorrect key was attempted to be used to decrypt the ciphertext.
 </p><p>
 <b>NOTE:</b> The purpose of this MAC (which is always computed by the
 ESAPI reference model implementing <code>Encryptor</code>) is to ensure the
 authenticity of the IV and ciphertext. Among other things, this prevents
 an adversary from substituting the IV with one of their own choosing.
 Because we don't know whether or not the recipient of this <code>CipherText</code>
 object will want to validate the authenticity or not, the reference
 implementation of <code>Encryptor</code> always computes it and includes it.
 The recipient of the ciphertext can then choose whether or not to validate
 it.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>authKey</CODE> - The secret key that is used for proving authenticity of
                                the IV and ciphertext. This key should be derived from
                                the <code>SecretKey</code> passed to the
                                <A HREF="../../../../org/owasp/esapi/Encryptor.html#encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)"><CODE>Encryptor.encrypt(javax.crypto.SecretKey, PlainText)</CODE></A>
                                and
                                <A HREF="../../../../org/owasp/esapi/Encryptor.html#decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)"><CODE>Encryptor.decrypt(javax.crypto.SecretKey, CipherText)</CODE></A>
                                methods or the "master" key when those corresponding
                                encrypt / decrypt methods are used. This authenticity key
                                should be the same length and for the same cipher algorithm
                                as this <code>SecretKey</code>. The method
                                <A HREF="../../../../org/owasp/esapi/crypto/CryptoHelper.html#computeDerivedKey(javax.crypto.SecretKey, int, java.lang.String)"><CODE>CryptoHelper.computeDerivedKey(SecretKey, int, String)</CODE></A>
                                is a secure way to produce this derived key.</DL>
</DD>
</DL>
<HR>

<A NAME="validateMAC(javax.crypto.SecretKey)"><!-- --></A><H3>
validateMAC</H3>
<PRE>
public boolean <B>validateMAC</B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/javax/crypto/SecretKey.html?is-external=true" title="class or interface in javax.crypto">SecretKey</A>&nbsp;authKey)</PRE>
<DL>
<DD>Validate the message authentication code (MAC) associated with the ciphertext.
 This is mostly meant to ensure that an attacker has not replaced the IV
 or raw ciphertext with something arbitrary. Note however that it will
 <i>not</i> detect the case where an attacker simply substitutes one
 valid ciphertext with another ciphertext.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>authKey</CODE> - The secret key that is used for proving authenticity of
                                the IV and ciphertext. This key should be derived from
                                the <code>SecretKey</code> passed to the
                                <A HREF="../../../../org/owasp/esapi/Encryptor.html#encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)"><CODE>Encryptor.encrypt(javax.crypto.SecretKey, PlainText)</CODE></A>
                                and
                                <A HREF="../../../../org/owasp/esapi/Encryptor.html#decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)"><CODE>Encryptor.decrypt(javax.crypto.SecretKey, CipherText)</CODE></A>
                                methods or the "master" key when those corresponding
                                encrypt / decrypt methods are used. This authenticity key
                                should be the same length and for the same cipher algorithm
                                as this <code>SecretKey</code>. The method
                                <A HREF="../../../../org/owasp/esapi/crypto/CryptoHelper.html#computeDerivedKey(javax.crypto.SecretKey, int, java.lang.String)"><CODE>CryptoHelper.computeDerivedKey(SecretKey, int, String)</CODE></A>
                                is a secure way to produce this derived key.
<DT><B>Returns:</B><DD>True if the ciphertext has not be tampered with, and false otherwise.</DL>
</DD>
</DL>
<HR>

<A NAME="asPortableSerializedByteArray()"><!-- --></A><H3>
asPortableSerializedByteArray</H3>
<PRE>
public byte[] <B>asPortableSerializedByteArray</B>()
                                     throws <A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Return this <code>CipherText</code> object as a portable (i.e., network byte
 ordered) serialized byte array. Note this is <b>not</b> the same as
 returning a serialized object using Java serialization. Instead this
 is a representation that all ESAPI implementations will use to pass
 ciphertext between different programming language implementations.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>A network byte-ordered serialized representation of this object.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="setCiphertext(byte[])"><!-- --></A><H3>
setCiphertext</H3>
<PRE>
public void <B>setCiphertext</B>(byte[]&nbsp;ciphertext)
                   throws <A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Set the raw ciphertext.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>ciphertext</CODE> - The raw ciphertext.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - Thrown if the MAC has already been computed
              via <A HREF="../../../../org/owasp/esapi/crypto/CipherText.html#computeAndStoreMAC(javax.crypto.SecretKey)"><CODE>computeAndStoreMAC(SecretKey)</CODE></A>.</DL>
</DD>
</DL>
<HR>

<A NAME="setIVandCiphertext(byte[], byte[])"><!-- --></A><H3>
setIVandCiphertext</H3>
<PRE>
public void <B>setIVandCiphertext</B>(byte[]&nbsp;iv,
                               byte[]&nbsp;ciphertext)
                        throws <A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Set the IV and raw ciphertext.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>iv</CODE> - The initialization vector.<DD><CODE>ciphertext</CODE> - The raw ciphertext.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getEncryptionTimestamp()"><!-- --></A><H3>
getEncryptionTimestamp</H3>
<PRE>
public long <B>getEncryptionTimestamp</B>()</PRE>
<DL>
<DD>Get stored timestamp representing when data was encrypted.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getSerialVersionUID()"><!-- --></A><H3>
getSerialVersionUID</H3>
<PRE>
public static long <B>getSerialVersionUID</B>()</PRE>
<DL>
<DD>Used in supporting <code>CipherText</code> serialization.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getSeparateMAC()"><!-- --></A><H3>
getSeparateMAC</H3>
<PRE>
public byte[] <B>getSeparateMAC</B>()</PRE>
<DL>
<DD>Return the separately calculated Message Authentication Code (MAC) that
 is computed via the <code>computeAndStoreMAC(SecretKey authKey)</code> method.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The copy of the computed MAC, or <code>null</code> if one is not used.</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <B>toString</B>()</PRE>
<DL>
<DD>More useful <code>toString()</code> method.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A></CODE> in class <CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="equals(java.lang.Object)"><!-- --></A><H3>
equals</H3>
<PRE>
public boolean <B>equals</B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;other)</PRE>
<DL>
<DD>
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A></CODE> in class <CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="hashCode()"><!-- --></A><H3>
hashCode</H3>
<PRE>
public int <B>hashCode</B>()</PRE>
<DL>
<DD>
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A></CODE> in class <CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="canEqual(java.lang.Object)"><!-- --></A><H3>
canEqual</H3>
<PRE>
protected boolean <B>canEqual</B>(<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;other)</PRE>
<DL>
<DD>Needed for correct definition of equals for general classes.
 (Technically not needed for 'final' classes though like this class
 though; this will just allow it to work in the future should we
 decide to allow * sub-classing of this class.)
 </p><p>
 See <CODE>http://www.artima.com/lejava/articles/equality.html</CODE>
 for full explanation.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/CipherText.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/owasp/esapi/crypto/CipherSpec.html" title="class in org.owasp.esapi.crypto"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/owasp/esapi/crypto/CipherTextSerializer.html" title="class in org.owasp.esapi.crypto"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/owasp/esapi/crypto/CipherText.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CipherText.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2010 <a href="http://www.owasp.org/index.php">The Open Web Application Security Project (OWASP)</a>. All Rights Reserved.
</BODY>
</HTML>
