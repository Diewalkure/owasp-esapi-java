<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>ESAPI - CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <div id="banner">
                    <span id="bannerLeft">
    
            ESAPI
    
            </span>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
    
            <div class="xleft">
        Last Published: 2010-02-10
                      </div>
            <div class="xright">            <a href="">ESAPI</a>
            
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
    
                             <h5>Project Documentation</h5>
            <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="project-info.html">Project Information</a>
                </li>
              
                
              
      
            
            
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
            <li class="expanded">
                    <a href="project-reports.html">Project Reports</a>
                  <ul>
                  
    <li class="none">
                    <a href="cobertura/index.html">Cobertura Test Coverage</a>
          </li>
                  
    <li class="none">
              <strong>CPD Report</strong>
        </li>
                  
    <li class="none">
                    <a href="findbugs.html">FindBugs Report</a>
          </li>
                  
    <li class="none">
                    <a href="apidocs/index.html">JavaDocs</a>
          </li>
                  
    <li class="none">
                    <a href="jdepend-report.html">JDepend</a>
          </li>
                  
    <li class="none">
                    <a href="pmd.html">PMD Report</a>
          </li>
                  
    <li class="none">
                    <a href="tlddoc/index.html">Taglibdoc documentation</a>
          </li>
                  
    <li class="none">
                    <a href="taglibvalidation.html">Tag library validation</a>
          </li>
                  
    <li class="none">
                    <a href="tagreference.html">Tag reference</a>
          </li>
                  
    <li class="none">
                    <a href="testapidocs/index.html">Test JavaDocs</a>
          </li>
              </ul>
        </li>
          </ul>
                                           <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img alt="Built by Maven" src="./images/logos/maven-feather.png"></img>
          </a>
                       
  

  
    
  
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>CPD Results</h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="http://pmd.sourceforge.net/cpd.html">CPD</a> 4.2.2.</p>
</div>
<div class="section"><h2>Duplications</h2>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\reference\accesscontrol\ExperimentalAccessController.java</td>
<td>21</td>
</tr>
<tr class="a"><td>org\owasp\esapi\reference\DefaultAccessController.java</td>
<td>22</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>	public DefaultAccessController() throws AccessControlException {
		ACRPolicyFileLoader policyDescriptor = new ACRPolicyFileLoader();
		PolicyDTO policyDTO = policyDescriptor.load();		
		ruleMap = policyDTO.getAccessControlRules();
	}
	
	public boolean isAuthorized(Object key, Object runtimeParameter) {
		try {
			AccessControlRule rule = (AccessControlRule)ruleMap.get(key);
			if(rule == null) {
				throw new AccessControlException(&quot;Access Denied&quot;,
						&quot;AccessControlRule was not found for key: &quot; + key); 
			}
			if(logger.isDebugEnabled()){ logger.debug(Logger.EVENT_SUCCESS, &quot;Evaluating Authorization Rule \&quot;&quot; + key + &quot;\&quot; Using class: &quot; + rule.getClass().getCanonicalName()); }
			return rule.isAuthorized(runtimeParameter);
		} catch(Exception e) {
			try {
				//Log the exception by throwing and then catching it.
				//TODO figure out what which string goes where.		
				throw new AccessControlException(&quot;Access Denied&quot;,
					&quot;An unhandled Exception was &quot; +
					&quot;caught, so access is denied.&quot;,  
					e);	
			} catch(AccessControlException ace) {
				//the exception was just logged. There's nothing left to do.
			}
			return false; //fail closed
		}
	}

	public void assertAuthorized(Object key, Object runtimeParameter)
		throws AccessControlException {
		boolean isAuthorized = false;
		try {
			AccessControlRule rule = (AccessControlRule)ruleMap.get(key);
			if(rule == null) {
				throw new AccessControlException(&quot;Access Denied&quot;, 
						&quot;AccessControlRule was not found for key: &quot; + key); 
			}
			if(logger.isDebugEnabled()){ logger.debug(Logger.EVENT_SUCCESS, &quot;Asserting Authorization Rule \&quot;&quot; + key + &quot;\&quot; Using class: &quot; + rule.getClass().getCanonicalName()); }
			isAuthorized = rule.isAuthorized(runtimeParameter);
		} catch(Exception e) {
			//TODO figure out what which string goes where.		
			throw new AccessControlException(&quot;Access Denied&quot;, &quot;An unhandled Exception was &quot; +
					&quot;caught, so access is denied.&quot; +
					&quot;AccessControlException.&quot;,
					e);
		}
		if(!isAuthorized) {
			throw new AccessControlException(&quot;Access Denied&quot;, 
					&quot;Access Denied for key: &quot; + key + 
					&quot; runtimeParameter: &quot; + runtimeParameter);
		}
	}
	
	/**
	 * @param action
	 * @param data
	 * @throws AccessControlException
	 * @see org.owasp.esapi.reference.FileBasedAccessController#assertAuthorizedForData(java.lang.String, java.lang.Object)
	 */
	public void assertAuthorizedForData(String action, Object data)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 Data&quot;, new Object[] {action, data});
	}

	/**
	 * @param filepath
	 * @throws AccessControlException
	 * @see org.owasp.esapi.reference.FileBasedAccessController#assertAuthorizedForFile(java.lang.String)
	 * @deprecated
	 */
	public void assertAuthorizedForFile(String filepath)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 File&quot;, new Object[] {filepath});
	}

	/**
	 * @param functionName
	 * @throws AccessControlException
	 * @see org.owasp.esapi.reference.FileBasedAccessController#assertAuthorizedForFunction(java.lang.String)
	 */
	public void assertAuthorizedForFunction(String functionName)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 Function&quot;, new Object[] {functionName});
	}

	/**
	 * @param serviceName
	 * @throws AccessControlException
	 * @see org.owasp.esapi.reference.FileBasedAccessController#assertAuthorizedForService(java.lang.String)
	 */
	public void assertAuthorizedForService(String serviceName)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 Service&quot;, new Object[] {serviceName});
	}

	/**
	 * @param url
	 * @throws AccessControlException
	 * @see org.owasp.esapi.reference.FileBasedAccessController#assertAuthorizedForURL(java.lang.String)
	 */
	public void assertAuthorizedForURL(String url)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 URL&quot;, new Object[] {url});
	}

	/**
	 * @param action
	 * @param data
	 * @return
	 * @see org.owasp.esapi.reference.FileBasedAccessController#isAuthorizedForData(java.lang.String, java.lang.Object)
	 */
	public boolean isAuthorizedForData(String action, Object data) {
		return this.isAuthorized(&quot;AC 1.0 Data&quot;, new Object[] {action, data});
	}

	/**
	 * @param filepath
	 * @return
	 * @see org.owasp.esapi.reference.FileBasedAccessController#isAuthorizedForFile(java.lang.String)
	 */
	public boolean isAuthorizedForFile(String filepath) {
		return this.isAuthorized(&quot;AC 1.0 File&quot;, new Object[] {filepath});
	}

	/**
	 * @param functionName
	 * @return
	 * @see org.owasp.esapi.reference.FileBasedAccessController#isAuthorizedForFunction(java.lang.String)
	 */
	public boolean isAuthorizedForFunction(String functionName) {
		return this.isAuthorized(&quot;AC 1.0 Function&quot;, new Object[] {functionName});
	}

	/**
	 * @param serviceName
	 * @return
	 * @see org.owasp.esapi.reference.FileBasedAccessController#isAuthorizedForService(java.lang.String)
	 */
	public boolean isAuthorizedForService(String serviceName) {
		return this.isAuthorized(&quot;AC 1.0 Service&quot;, new Object[] {serviceName});
	}

	/**
	 * @param url
	 * @return
	 * @see org.owasp.esapi.reference.FileBasedAccessController#isAuthorizedForURL(java.lang.String)
	 */
	public boolean isAuthorizedForURL(String url) {
		return this.isAuthorized(&quot;AC 1.0 URL&quot;, new Object[] {url});
	}
}</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>174</td>
</tr>
<tr class="a"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>236</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>    private final static byte[] _URL_SAFE_ALPHABET =
    {
      (byte)'A', (byte)'B', (byte)'C', (byte)'D', (byte)'E', (byte)'F', (byte)'G',
      (byte)'H', (byte)'I', (byte)'J', (byte)'K', (byte)'L', (byte)'M', (byte)'N',
      (byte)'O', (byte)'P', (byte)'Q', (byte)'R', (byte)'S', (byte)'T', (byte)'U', 
      (byte)'V', (byte)'W', (byte)'X', (byte)'Y', (byte)'Z',
      (byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g',
      (byte)'h', (byte)'i', (byte)'j', (byte)'k', (byte)'l', (byte)'m', (byte)'n',
      (byte)'o', (byte)'p', (byte)'q', (byte)'r', (byte)'s', (byte)'t', (byte)'u', 
      (byte)'v', (byte)'w', (byte)'x', (byte)'y', (byte)'z',
      (byte)'0', (byte)'1', (byte)'2', (byte)'3', (byte)'4', (byte)'5', 
      (byte)'6', (byte)'7', (byte)'8', (byte)'9', (byte)'-', (byte)'_'</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\reference\JavaLogFactory.java</td>
<td>271</td>
</tr>
<tr class="a"><td>org\owasp\esapi\reference\Log4JLogFactory.java</td>
<td>248</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>        	if (!jlogger.isEnabledFor( level )) return;
        	
            // create a random session number for the user to represent the user's 'session', if it doesn't exist already
            String sid = null;
            HttpServletRequest request = ESAPI.httpUtilities().getCurrentRequest();
            if ( request != null ) {
                HttpSession session = request.getSession( false );
                if ( session != null ) {
	                sid = (String)session.getAttribute(&quot;ESAPI_SESSION&quot;);
	                // if there is no session ID for the user yet, we create one and store it in the user's session
		            if ( sid == null ) {
		            	sid = &quot;&quot;+ ESAPI.randomizer().getRandomInteger(0, 1000000);
		            	session.setAttribute(&quot;ESAPI_SESSION&quot;, sid);
		            }
                }
            }
            
            // ensure there's something to log
            if ( message == null ) {
            	message = &quot;&quot;;
            }
            
            // ensure no CRLF injection into logs for forging records
            String clean = message.replace( '\n', '_' ).replace( '\r', '_' );
            if ( ESAPI.securityConfiguration().getLogEncodingRequired() ) {
            	clean = ESAPI.encoder().encodeForHTML(message);
                if (!message.equals(clean)) {
                    clean += &quot; (Encoded)&quot;;
                }
            }
            
			// log user information - username:session@ipaddr
        	User user = ESAPI.authenticator().getCurrentUser();            
			String userInfo = &quot;&quot;;
			if ( user != null &amp;&amp; type != null) {
				userInfo = user.getAccountName()+ &quot;:&quot; + sid + &quot;@&quot;+ user.getLastHostAddress();
			}

			// log server, port, app name, module name -- server:80/app/module
			StringBuilder appInfo = new StringBuilder();
			if ( ESAPI.currentRequest() != null &amp;&amp; logServerIP ) {
				appInfo.append( ESAPI.currentRequest().getLocalAddr() + &quot;:&quot; + ESAPI.currentRequest().getLocalPort() );
			}
			if ( logAppName ) {
				appInfo.append( &quot;/&quot; + applicationName );
			}
			appInfo.append( &quot;/&quot;  + moduleName );
			
			// log the message
			jlogger.log(level, &quot;[&quot; + userInfo + &quot; -&gt; &quot; + appInfo + &quot;] &quot; + clean, throwable);
        }

        /**
    	* {@inheritDoc}
    	*/
        public boolean isDebugEnabled() {
    	    return jlogger.isEnabledFor(Level.DEBUG);</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\waf\ESAPIWebApplicationFirewallFilter.java</td>
<td>304</td>
</tr>
<tr class="a"><td>org\owasp\esapi\waf\ESAPIWebApplicationFirewallFilter.java</td>
<td>361</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>			logger.debug(Logger.EVENT_SUCCESS,  &quot;  Applying AFTER CHAIN rule:  &quot; + rule.getClass().getName() );

			/*
			 * The rules execute in check(). The check() method will also log. All we have
			 * to do is decide what other actions to take.
			 */
			Action action = rule.check(request, response, httpResponse);

			if ( action.isActionNecessary() ) {

				if ( action instanceof BlockAction ) {
					if ( response != null ) {
						response.setStatus(appGuardConfig.getDefaultResponseCode());
					} else {
						httpResponse.setStatus(appGuardConfig.getDefaultResponseCode());
					}
					return;

				} else if ( action instanceof RedirectAction ) {
					sendRedirect(response, httpResponse, ((RedirectAction)action).getRedirectURL());
					return;

				} else if ( action instanceof DefaultAction ) {

					switch ( AppGuardianConfiguration.DEFAULT_FAIL_ACTION) {
						case AppGuardianConfiguration.BLOCK:
							if ( response != null ) {
								response.setStatus(appGuardConfig.getDefaultResponseCode());
							} else {
								httpResponse.setStatus(appGuardConfig.getDefaultResponseCode());
							}
							return;

						case AppGuardianConfiguration.REDIRECT:
							sendRedirect(response, httpResponse);
							return;
					}
				}
			}
		}</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\waf\rules\RuleUtil.java</td>
<td>52</td>
</tr>
<tr class="a"><td>org\owasp\esapi\waf\rules\RuleUtil.java</td>
<td>97</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>			Object o = en.nextElement();

			if ( o instanceof String ) {

				if ( s.equals((String)o)) {
					return true;
				}

			} else if ( o instanceof Integer ) {

				try {
					if ( Integer.parseInt(s) == ((Integer)o).intValue() ) {
						return true;
					}
				} catch (Exception e) {}

			} else if ( o instanceof Long ) {

				try {
					if ( Long.parseLong(s) == ((Long)o).longValue() ) {
						return true;
					}
				} catch (Exception e) {}

			} else if ( o instanceof Double ) {

				try {
					if ( Double.parseDouble(s) == ((Double)o).doubleValue() ) {
						return true;
					}
				} catch (Exception e) {}
			}

		}

		return false;
	}

	public static boolean testValue(String s, String test, int operator) {</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\waf\ESAPIWebApplicationFirewallFilter.java</td>
<td>249</td>
</tr>
<tr class="a"><td>org\owasp\esapi\waf\ESAPIWebApplicationFirewallFilter.java</td>
<td>310</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>			Action action = rule.check(request, response, httpResponse);

			if ( action.isActionNecessary() ) {

				if ( action instanceof BlockAction ) {
					if ( response != null ) {
						response.setStatus(appGuardConfig.getDefaultResponseCode());
					} else {
						httpResponse.setStatus(appGuardConfig.getDefaultResponseCode());
					}
					return;

				} else if ( action instanceof RedirectAction ) {
					sendRedirect(response, httpResponse, ((RedirectAction)action).getRedirectURL());
					return;

				} else if ( action instanceof DefaultAction ) {

					switch ( AppGuardianConfiguration.DEFAULT_FAIL_ACTION) {
						case AppGuardianConfiguration.BLOCK:
							if ( response != null ) {
								response.setStatus(appGuardConfig.getDefaultResponseCode());
							} else {
								httpResponse.setStatus(appGuardConfig.getDefaultResponseCode());
							}
							return;

						case AppGuardianConfiguration.REDIRECT:
							sendRedirect(response, httpResponse);
							return;
					}
				}
			}
		}</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>253</td>
</tr>
<tr class="a"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>319</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>    private final static byte[] _ORDERED_DECODABET =
    {   
      -9,-9,-9,-9,-9,-9,-9,-9,-9,                 // Decimal  0 -  8
      -5,-5,                                      // Whitespace: Tab and Linefeed
      -9,-9,                                      // Decimal 11 - 12
      -5,                                         // Whitespace: Carriage Return
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,     // Decimal 14 - 26
      -9,-9,-9,-9,-9,                             // Decimal 27 - 31
      -5,                                         // Whitespace: Space
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,              // Decimal 33 - 42
      -9,                                         // Plus sign at decimal 43
      -9,                                         // Decimal 44</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>176</td>
</tr>
<tr class="a"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>305</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>      (byte)'A', (byte)'B', (byte)'C', (byte)'D', (byte)'E', (byte)'F', (byte)'G',
      (byte)'H', (byte)'I', (byte)'J', (byte)'K', (byte)'L', (byte)'M', (byte)'N',
      (byte)'O', (byte)'P', (byte)'Q', (byte)'R', (byte)'S', (byte)'T', (byte)'U',
      (byte)'V', (byte)'W', (byte)'X', (byte)'Y', (byte)'Z',
      (byte)'_',</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>193</td>
</tr>
<tr class="a"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>253</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>    private final static byte[] _URL_SAFE_DECODABET =
    {   
      -9,-9,-9,-9,-9,-9,-9,-9,-9,                 // Decimal  0 -  8
      -5,-5,                                      // Whitespace: Tab and Linefeed
      -9,-9,                                      // Decimal 11 - 12
      -5,                                         // Whitespace: Carriage Return
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,     // Decimal 14 - 26
      -9,-9,-9,-9,-9,                             // Decimal 27 - 31
      -5,                                         // Whitespace: Space
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,              // Decimal 33 - 42</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>179</td>
</tr>
<tr class="a"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>309</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>      (byte)'_',
      (byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g',
      (byte)'h', (byte)'i', (byte)'j', (byte)'k', (byte)'l', (byte)'m', (byte)'n',
      (byte)'o', (byte)'p', (byte)'q', (byte)'r', (byte)'s', (byte)'t', (byte)'u',
      (byte)'v', (byte)'w', (byte)'x', (byte)'y', (byte)'z'</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\filters\SecurityWrapperResponse.java</td>
<td>77</td>
</tr>
<tr class="a"><td>org\owasp\esapi\reference\DefaultHTTPUtilities.java</td>
<td>142</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>    public void addCookie(HttpServletResponse response, Cookie cookie) {
        String name = cookie.getName();
        String value = cookie.getValue();
        int maxAge = cookie.getMaxAge();
        String domain = cookie.getDomain();
        String path = cookie.getPath();
        boolean secure = cookie.getSecure();

        // validate the name and value
        ValidationErrorList errors = new ValidationErrorList();
        String cookieName = ESAPI.validator().getValidInput(&quot;cookie name&quot;, name, &quot;HTTPCookieName&quot;, 50, false, errors);
        String cookieValue = ESAPI.validator().getValidInput(&quot;cookie value&quot;, value, &quot;HTTPCookieValue&quot;, 5000, false, errors);

        // if there are no errors, then set the cookie either with a header or normally
        if (errors.size() == 0) {</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>205</td>
</tr>
<tr class="a"><td>org\owasp\esapi\codecs\Base64.java</td>
<td>267</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>      -9,                                         // Slash at decimal 47
      52,53,54,55,56,57,58,59,60,61,              // Numbers zero through nine
      -9,-9,-9,                                   // Decimal 58 - 60
      -1,                                         // Equals sign at decimal 61
      -9,-9,-9,                                   // Decimal 62 - 64
      0,1,2,3,4,5,6,7,8,9,10,11,12,13,            // Letters 'A' through 'N'
      14,15,16,17,18,19,20,21,22,23,24,25,        // Letters 'O' through 'Z'
      -9,-9,-9,-9,                                // Decimal 91 - 94</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org\owasp\esapi\codecs\MySQLCodec.java</td>
<td>147</td>
</tr>
<tr class="a"><td>org\owasp\esapi\codecs\OracleCodec.java</td>
<td>62</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>	public Character decodeCharacter( PushbackString input ) {
		input.mark();
		Character first = input.next();
		if ( first == null ) {
			input.reset();
			return null;
		}

		// if this is not an encoded character, return null
		if ( first.charValue() != '\'' ) {
			input.reset();
			return null;
		}

		Character second = input.next();
		if ( second == null ) {
			input.reset();
			return null;
		}
		
		// if this is not an encoded character, return null
		if ( second.charValue() != '\'' ) {
			input.reset();
			return null;
		}
		return( Character.valueOf( '\'' ) );
	}</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2010
    
          The Open Web Application Security Project (OWASP)
          
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
