<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.4.2_16) on Wed Mar 05 23:46:35 EST 2008 -->
<TITLE>
HTTPUtilities
</TITLE>

<META NAME="keywords" CONTENT="org.owasp.esapi.HTTPUtilities class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="HTTPUtilities";
}
</SCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/HTTPUtilities.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/owasp/esapi/Executor.html" title="class in org.owasp.esapi"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../org/owasp/esapi/IntrusionDetector.html" title="class in org.owasp.esapi"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="HTTPUtilities.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.owasp.esapi</FONT>
<BR>
Class HTTPUtilities</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by"><B>org.owasp.esapi.HTTPUtilities</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></DD>
</DL>
<HR>
<DL>
<DT>public class <B>HTTPUtilities</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></DL>

<P>
Reference implementation of the IHTTPUtilities interface. This implementation
 uses the Apache Commons FileUploader library, which in turn uses the Apache
 Commons IO library.
 <P>
 To simplify the interface, this class uses the current request and response that
 are tracked by ThreadLocal variables in the Authenticator. This means that you
 must have called ESAPI.authenticator().setCurrentHTTP(null, response) before
 calling these methods. This is done automatically by the Authenticator.login() method.
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>June 1, 2007</DD>
<DT><B>Author:</B></DT>
  <DD>Jeff Williams (jeff.williams .at. aspectsecurity.com) <a
         href="http://www.aspectsecurity.com">Aspect Security</a></DD>
<DT><B>See Also:</B><DD><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces"><CODE>IHTTPUtilities</CODE></A></DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->


<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#HTTPUtilities()">HTTPUtilities</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#addCSRFToken(java.lang.String)">addCSRFToken</A></B>(java.lang.String&nbsp;href)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds the current user's CSRF token (see User.getCSRFToken()) to the URL for purposes of preventing CSRF attacks.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.servlet.http.HttpSession</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#changeSessionIdentifier()">changeSessionIdentifier</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invalidate the old session after copying all of its contents to a newly created session with a new session id.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#decryptHiddenField(java.lang.String)">decryptHiddenField</A></B>(java.lang.String&nbsp;encrypted)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts an encrypted hidden field value and returns the cleartest.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Map</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#decryptQueryString(java.lang.String)">decryptQueryString</A></B>(java.lang.String&nbsp;encrypted)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Takes an encrypted querystring and returns a Map containing the original parameters.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Map</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#decryptStateFromCookie()">decryptStateFromCookie</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retrieves a map of data from the encrypted cookie.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#encryptHiddenField(java.lang.String)">encryptHiddenField</A></B>(java.lang.String&nbsp;value)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encrypts a hidden field value for use in HTML.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#encryptQueryString(java.lang.String)">encryptQueryString</A></B>(java.lang.String&nbsp;query)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Takes a querystring (i.e.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#encryptStateInCookie(java.util.Map)">encryptStateInCookie</A></B>(java.util.Map&nbsp;cleartext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stores a Map of data in an encrypted cookie.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#getSafeFileUploads(java.io.File, java.io.File)">getSafeFileUploads</A></B>(java.io.File&nbsp;tempDir,
                   java.io.File&nbsp;finalDir)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Uses the Apache Commons FileUploader to parse the multipart HTTP request
 and extract any files therein.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#isSecureChannel()">isSecureChannel</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns true if the request was transmitted over an SSL enabled
 connection.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#killAllCookies()">killAllCookies</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kill all cookies received in the last request from the browser.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#killCookie(java.lang.String)">killCookie</A></B>(java.lang.String&nbsp;name)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kills the specified cookie by setting a new cookie that expires immediately.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#safeAddCookie(java.lang.String, java.lang.String, int, java.lang.String, java.lang.String)">safeAddCookie</A></B>(java.lang.String&nbsp;name,
              java.lang.String&nbsp;value,
              int&nbsp;maxAge,
              java.lang.String&nbsp;domain,
              java.lang.String&nbsp;path)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a cookie to the HttpServletResponse that uses Secure and HttpOnly
 flags.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#safeAddHeader(java.lang.String, java.lang.String)">safeAddHeader</A></B>(java.lang.String&nbsp;name,
              java.lang.String&nbsp;value)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a header to an HttpServletResponse after checking for special characters (such as CRLF injection) that could enable 
 attacks like response splitting and other header-based attacks that nobody has thought of yet.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#safeEncodeRedirectURL(java.lang.String)">safeEncodeRedirectURL</A></B>(java.lang.String&nbsp;url)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return exactly what was sent to prevent URL rewriting.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#safeEncodeURL(java.lang.String)">safeEncodeURL</A></B>(java.lang.String&nbsp;url)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return exactly what was sent to prevent URL rewriting.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#safeSendForward(java.lang.String, java.lang.String)">safeSendForward</A></B>(java.lang.String&nbsp;context,
                java.lang.String&nbsp;location)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method perform a forward to any resource located inside the WEB-INF directory.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#safeSendRedirect(java.lang.String, java.lang.String)">safeSendRedirect</A></B>(java.lang.String&nbsp;context,
                 java.lang.String&nbsp;location)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method generates a redirect response that can only be used to redirect the browser to safe locations.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#safeSetContentType()">safeSetContentType</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the character encoding on every HttpServletResponse in order to limit
 the ways in which the input data can be represented.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#setNoCacheHeaders()">setNoCacheHeaders</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set headers to protect sensitive information against being cached in the
 browser.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/owasp/esapi/HTTPUtilities.html#verifyCSRFToken()">verifyCSRFToken</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks the CSRF token in the URL (see User.getCSRFToken()) against the user's CSRF token and
 throws an IntrusionException if it is missing.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->


<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="HTTPUtilities()"><!-- --></A><H3>
HTTPUtilities</H3>
<PRE>
public <B>HTTPUtilities</B>()</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="addCSRFToken(java.lang.String)"><!-- --></A><H3>
addCSRFToken</H3>
<PRE>
public java.lang.String <B>addCSRFToken</B>(java.lang.String&nbsp;href)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Adds the current user's CSRF token (see User.getCSRFToken()) to the URL for purposes of preventing CSRF attacks.
 This method should be used on all URLs to be put into all links and forms the application generates.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#addCSRFToken(java.lang.String)">addCSRFToken</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the updated href with the CSRF token parameter<DT><B>See Also:</B><DD><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#addCSRFToken(java.lang.String)"><CODE>IHTTPUtilities.addCSRFToken(java.lang.String)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="safeAddCookie(java.lang.String, java.lang.String, int, java.lang.String, java.lang.String)"><!-- --></A><H3>
safeAddCookie</H3>
<PRE>
public void <B>safeAddCookie</B>(java.lang.String&nbsp;name,
                          java.lang.String&nbsp;value,
                          int&nbsp;maxAge,
                          java.lang.String&nbsp;domain,
                          java.lang.String&nbsp;path)
                   throws <A HREF="../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</A></PRE>
<DL>
<DD>Adds a cookie to the HttpServletResponse that uses Secure and HttpOnly
 flags. This implementation does not use the addCookie method because
 it does not support HttpOnly, so it just creates a cookie header manually.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#safeAddCookie(java.lang.String, java.lang.String, int, java.lang.String, java.lang.String)">safeAddCookie</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - the name<DD><CODE>value</CODE> - the value<DD><CODE>domain</CODE> - the domain<DD><CODE>path</CODE> - the path<DD><CODE>maxAge</CODE> - the max age
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</A></CODE><DT><B>See Also:</B><DD><CODE>org.owasp.esapi.interfaces.IHTTPUtilities#safeAddCookie(java.lang.String,
      java.lang.String, java.util.Date, java.lang.String,
      java.lang.String, javax.servlet.http.HttpServletResponse)</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="safeAddHeader(java.lang.String, java.lang.String)"><!-- --></A><H3>
safeAddHeader</H3>
<PRE>
public void <B>safeAddHeader</B>(java.lang.String&nbsp;name,
                          java.lang.String&nbsp;value)
                   throws <A HREF="../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Adds a header to an HttpServletResponse after checking for special characters (such as CRLF injection) that could enable 
 attacks like response splitting and other header-based attacks that nobody has thought of yet.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#safeAddHeader(java.lang.String, java.lang.String)">safeAddHeader</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - the name<DD><CODE>value</CODE> - the value
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="safeEncodeURL(java.lang.String)"><!-- --></A><H3>
safeEncodeURL</H3>
<PRE>
public java.lang.String <B>safeEncodeURL</B>(java.lang.String&nbsp;url)</PRE>
<DL>
<DD>Return exactly what was sent to prevent URL rewriting. URL rewriting is intended to be a session management
 scheme that doesn't require cookies, but exposes the sessionid in many places, including the URL bar,
 favorites, HTML files in cache, logs, and cut-and-paste links. For these reasons, session rewriting is
 more dangerous than the evil cookies it was intended to replace.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>url</CODE> - 
<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="safeEncodeRedirectURL(java.lang.String)"><!-- --></A><H3>
safeEncodeRedirectURL</H3>
<PRE>
public java.lang.String <B>safeEncodeRedirectURL</B>(java.lang.String&nbsp;url)</PRE>
<DL>
<DD>Return exactly what was sent to prevent URL rewriting. URL rewriting is intended to be a session management
 scheme that doesn't require cookies, but exposes the sessionid in many places, including the URL bar,
 favorites, HTML files in cache, logs, and cut-and-paste links. For these reasons, session rewriting is
 more dangerous than the evil cookies it was intended to replace.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>url</CODE> - 
<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="changeSessionIdentifier()"><!-- --></A><H3>
changeSessionIdentifier</H3>
<PRE>
public javax.servlet.http.HttpSession <B>changeSessionIdentifier</B>()
                                                       throws <A HREF="../../../org/owasp/esapi/errors/AuthenticationException.html" title="class in org.owasp.esapi.errors">AuthenticationException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Invalidate the old session after copying all of its contents to a newly created session with a new session id.
 Note that this is different from logging out and creating a new session identifier that does not contain the
 existing session contents. Care should be taken to use this only when the existing session does not contain
 hazardous contents.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#changeSessionIdentifier()">changeSessionIdentifier</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the http session
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/AuthenticationException.html" title="class in org.owasp.esapi.errors">AuthenticationException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="verifyCSRFToken()"><!-- --></A><H3>
verifyCSRFToken</H3>
<PRE>
public void <B>verifyCSRFToken</B>()
                     throws <A HREF="../../../org/owasp/esapi/errors/IntrusionException.html" title="class in org.owasp.esapi.errors">IntrusionException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Checks the CSRF token in the URL (see User.getCSRFToken()) against the user's CSRF token and
 throws an IntrusionException if it is missing.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#verifyCSRFToken()">verifyCSRFToken</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/IntrusionException.html" title="class in org.owasp.esapi.errors">IntrusionException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="decryptHiddenField(java.lang.String)"><!-- --></A><H3>
decryptHiddenField</H3>
<PRE>
public java.lang.String <B>decryptHiddenField</B>(java.lang.String&nbsp;encrypted)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Decrypts an encrypted hidden field value and returns the cleartest. If the field does not decrypt properly,
 an IntrusionException is thrown to indicate tampering.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#decryptHiddenField(java.lang.String)">decryptHiddenField</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encrypted</CODE> - 
<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="decryptQueryString(java.lang.String)"><!-- --></A><H3>
decryptQueryString</H3>
<PRE>
public java.util.Map <B>decryptQueryString</B>(java.lang.String&nbsp;encrypted)
                                 throws <A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Takes an encrypted querystring and returns a Map containing the original parameters.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#decryptQueryString(java.lang.String)">decryptQueryString</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>encrypted</CODE> - 
<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="decryptStateFromCookie()"><!-- --></A><H3>
decryptStateFromCookie</H3>
<PRE>
public java.util.Map <B>decryptStateFromCookie</B>()
                                     throws <A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Retrieves a map of data from the encrypted cookie.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#decryptStateFromCookie()">decryptStateFromCookie</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE><DT><B>See Also:</B><DD><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#decryptStateFromCookie()"><CODE>IHTTPUtilities.decryptStateFromCookie()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="encryptHiddenField(java.lang.String)"><!-- --></A><H3>
encryptHiddenField</H3>
<PRE>
public java.lang.String <B>encryptHiddenField</B>(java.lang.String&nbsp;value)
                                    throws <A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Encrypts a hidden field value for use in HTML.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#encryptHiddenField(java.lang.String)">encryptHiddenField</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>value</CODE> - 
<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="encryptQueryString(java.lang.String)"><!-- --></A><H3>
encryptQueryString</H3>
<PRE>
public java.lang.String <B>encryptQueryString</B>(java.lang.String&nbsp;query)
                                    throws <A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Takes a querystring (i.e. everything after the ? in the URL) and returns an encrypted string containing the parameters.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#encryptQueryString(java.lang.String)">encryptQueryString</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="encryptStateInCookie(java.util.Map)"><!-- --></A><H3>
encryptStateInCookie</H3>
<PRE>
public void <B>encryptStateInCookie</B>(java.util.Map&nbsp;cleartext)
                          throws <A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Stores a Map of data in an encrypted cookie.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#encryptStateInCookie(java.util.Map)">encryptStateInCookie</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE><DT><B>See Also:</B><DD><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#encryptStateInCookie(java.util.Map)"><CODE>IHTTPUtilities.encryptStateInCookie(java.util.Map)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getSafeFileUploads(java.io.File, java.io.File)"><!-- --></A><H3>
getSafeFileUploads</H3>
<PRE>
public void <B>getSafeFileUploads</B>(java.io.File&nbsp;tempDir,
                               java.io.File&nbsp;finalDir)
                        throws <A HREF="../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</A></PRE>
<DL>
<DD>Uses the Apache Commons FileUploader to parse the multipart HTTP request
 and extract any files therein. Note that the progress of any uploads is
 put into a session attribute, where it can be retrieved with a simple
 JSP.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#getSafeFileUploads(java.io.File, java.io.File)">getSafeFileUploads</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>tempDir</CODE> - the temp dir<DD><CODE>finalDir</CODE> - the final dir
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</A></CODE> - the validation exception<DT><B>See Also:</B><DD><CODE>org.owasp.esapi.interfaces.IHTTPUtilities#safeGetFileUploads(javax.servlet.http.HttpServletRequest,
      java.io.File, java.io.File, int)</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="isSecureChannel()"><!-- --></A><H3>
isSecureChannel</H3>
<PRE>
public boolean <B>isSecureChannel</B>()</PRE>
<DL>
<DD>Returns true if the request was transmitted over an SSL enabled
 connection. This implementation ignores the built-in isSecure() method
 and uses the URL to determine if the request was transmitted over SSL.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#isSecureChannel()">isSecureChannel</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="killAllCookies()"><!-- --></A><H3>
killAllCookies</H3>
<PRE>
public void <B>killAllCookies</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Kill all cookies received in the last request from the browser. Note that new cookies set by the application in
 this response may not be killed by this method.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#killAllCookies()">killAllCookies</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="killCookie(java.lang.String)"><!-- --></A><H3>
killCookie</H3>
<PRE>
public void <B>killCookie</B>(java.lang.String&nbsp;name)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>Kills the specified cookie by setting a new cookie that expires immediately.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#killCookie(java.lang.String)">killCookie</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - the cookie name</DL>
</DD>
</DL>
<HR>

<A NAME="safeSendForward(java.lang.String, java.lang.String)"><!-- --></A><H3>
safeSendForward</H3>
<PRE>
public void <B>safeSendForward</B>(java.lang.String&nbsp;context,
                            java.lang.String&nbsp;location)
                     throws <A HREF="../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A>,
                            javax.servlet.ServletException,
                            java.io.IOException</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>This method perform a forward to any resource located inside the WEB-INF directory. Forwarding to
 publically accessible resources can be dangerous, as the request will have already passed the URL
 based access control check. This method ensures that you can only forward to non-publically
 accessible resources.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#safeSendForward(java.lang.String, java.lang.String)">safeSendForward</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>context</CODE> - <DD><CODE>location</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE>
<DD><CODE>javax.servlet.ServletException</CODE>
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="safeSendRedirect(java.lang.String, java.lang.String)"><!-- --></A><H3>
safeSendRedirect</H3>
<PRE>
public void <B>safeSendRedirect</B>(java.lang.String&nbsp;context,
                             java.lang.String&nbsp;location)
                      throws <A HREF="../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</A>,
                             java.io.IOException</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></B></DD>
<DD>This method generates a redirect response that can only be used to redirect the browser to safe locations.
 Importantly, redirect requests can be modified by attackers, so do not rely information contained within redirect
 requests, and do not include sensitive information in a redirect.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#safeSendRedirect(java.lang.String, java.lang.String)">safeSendRedirect</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>location</CODE> - the URL to redirect to
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - Signals that an I/O exception has occurred.
<DD><CODE><A HREF="../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</A></CODE> - the validation exception</DL>
</DD>
</DL>
<HR>

<A NAME="safeSetContentType()"><!-- --></A><H3>
safeSetContentType</H3>
<PRE>
public void <B>safeSetContentType</B>()</PRE>
<DL>
<DD>Set the character encoding on every HttpServletResponse in order to limit
 the ways in which the input data can be represented. This prevents
 malicious users from using encoding and multi-byte escape sequences to
 bypass input validation routines. The default is text/html; charset=UTF-8
 character encoding, which is the default in early versions of HTML and
 HTTP. See RFC 2047 (http://ds.internic.net/rfc/rfc2045.txt) for more
 information about character encoding and MIME.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#safeSetContentType()">safeSetContentType</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>See Also:</B><DD><CODE>org.owasp.esapi.interfaces.IHTTPUtilities#safeSetContentType(java.lang.String)</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="setNoCacheHeaders()"><!-- --></A><H3>
setNoCacheHeaders</H3>
<PRE>
public void <B>setNoCacheHeaders</B>()</PRE>
<DL>
<DD>Set headers to protect sensitive information against being cached in the
 browser.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html#setNoCacheHeaders()">setNoCacheHeaders</A></CODE> in interface <CODE><A HREF="../../../org/owasp/esapi/interfaces/IHTTPUtilities.html" title="interface in org.owasp.esapi.interfaces">IHTTPUtilities</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>See Also:</B><DD><CODE>org.owasp.esapi.interfaces.IHTTPUtilities#setNoCacheHeaders(javax.servlet.http.HttpServletResponse)</CODE></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/HTTPUtilities.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/owasp/esapi/Executor.html" title="class in org.owasp.esapi"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../org/owasp/esapi/IntrusionDetector.html" title="class in org.owasp.esapi"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="HTTPUtilities.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
